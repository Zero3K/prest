/* -*- Mode: c++; tab-width: 4; indent-tabs-mode: t; c-basic-offset: 4 -*-
**
** Copyright (C) 2024 Presto Project.  All rights reserved.
**
** This file is part of the Presto web browser.  It may not be distributed
** under any circumstances.
*/

// This file is automatically generated from modules/tlsclient/selftest/tlsclient_basic.ot
// Do not edit manually

#include "core/pch_jumbo.h"

#ifdef SELFTEST

#include "modules/selftest/src/testutils.h"
#include "modules/tlsclient/tlsclient.h"

// Test group for TLSClient module
class ST_tlsclient : public Test
{
public:
    ST_tlsclient() : Test("tlsclient") {}
    
    // TLS Context Creation test
    BOOL test_tls_context_creation()
    {
        TLSContext* ctx = tls_create_context(ISCLIENT);
        if (ctx == NULL)
            return FALSE;
        
        tls_destroy_context(ctx);
        return TRUE;
    }
    
    // TLS Error Handling test
    BOOL test_tls_error_handling()
    {
        const char* error_str = tls_get_error_string(0);
        if (error_str == NULL)
            return FALSE;
        if (strcmp(error_str, "No error") != 0)
            return FALSE;
        return TRUE;
    }
    
    // TLS Configuration test
    BOOL test_tls_configuration()
    {
        TLSContext* ctx = tls_create_context(ISCLIENT);
        if (ctx == NULL)
            return FALSE;
        
        int result = tls_set_cipher_list(ctx, "TLS_AES_256_GCM_SHA384");
        if (result != 1) {
            tls_destroy_context(ctx);
            return FALSE;
        }
        
        result = tls_set_verify_mode(ctx, 0);
        if (result != 1) {
            tls_destroy_context(ctx);
            return FALSE;
        }
        
        tls_destroy_context(ctx);
        return TRUE;
    }
};

// Create function expected by the selftest system
void* ST_tlsclient_Create(int)
{
    return new ST_tlsclient();
}

#endif // SELFTEST